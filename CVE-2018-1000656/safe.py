from flask import Flask, request, jsonify

app = Flask(__name__)

# Secure authentication check that applies to all HTTP methods
@app.before_request
def check_authentication():
    if request.path != '/':  # Skip the public route
        # Check for Authorization header for all methods
        auth_token = request.headers.get('Authorization')
        if not auth_token or auth_token != 'secret-token':
            return jsonify({"error": "Unauthorized"}), 401

# Protected route
@app.route('/protected', methods=['GET', 'POST', 'OPTIONS', 'HEAD', 'PUT', 'DELETE'])
def protected():
    return jsonify({"message": "Welcome to the protected route!"})

# Public route
@app.route('/', methods=['GET'])
def index():
    return jsonify({"message": "This is a public route."})

if __name__ == "__main__":
    app.run(debug=True, host='0.0.0.0')

